{% extends 'base.html' %}
{% from '_macros.html' import pagination_widget %}

{% block title %}занятия в {{ group.name }}{% endblock %}

{% block page_content %}

    <div class="page-header">
        <h1>занятия в {{ group.name }}</h1>
    </div>

    <a href="{{ url_for('lessons.create_lesson',group_id=group.id) }}" class="btn btn-primary margined_button">
        новое занятие
    </a>

    <table class="table">
        <tr>
            <th>месяц</th>
            <th>учеников</th>
            <th>занятий</th>
            <th>% посещения</th>
            <th>оплата</th>
            <th></th>
        </tr>
        {% for month in months %}
            <tr>
                <td>
                    <a href="{{ url_for('lessons.lessons_in_month',group_id=group.id,month_number=month.month_number) }}">
                        {{ month.month_name }}
                    </a>
                </td>
                <td>{{ month.students_count }}</td>
                <td>{{ month.lessons_count }}</td>
                <td>{{ month.attendings_percent }}</td>
                <td>{{ month.payments_confirmed }} / {{ month.payments }} / {{ month.students_count }}</td>
            </tr>
        {% endfor %}
    </table>

    <table class="table">
        <tr>
            <th>дата</th>
            <th>преподаватель</th>
            <th>учеников</th>
            <th></th>
        </tr>
        {% for lesson in lessons %}
            <tr>
                <td>
                    <a href="{{ url_for('lessons.lessons_in_month',group_id=lesson.group_id,month_number=number_of_month(lesson.date)) }}">
                        {{ lesson.date }}
                    </a>
                </td>
                <td>{{ lesson.teacher.fio }}</td>
                <td>{{ lesson.attendings_was.count() }}
                    / {{ lesson.group.students_in_month(number_of_month(lesson.date)).count() }}</td>
            </tr>
        {% endfor %}
    </table>

    <div class="footer">
        {{ pagination_widget(pagination, 'lessons.lessons_list', group_id=group.id) }}
    </div>
{% endblock %}